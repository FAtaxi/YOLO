<!DOCTYPE html>
<html lang="nl">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Admin - Taxi Boeking</title>
  <link rel="stylesheet" href="styles.css">
</head>
<body>
  <div class="container" id="loginContainer">
    <h2>Admin inloggen</h2>
    <form id="loginForm">
      <div class="info">Voer alleen het admin-wachtwoord in om toegang te krijgen.</div>
      <label for="wachtwoord">Wachtwoord</label>
      <input type="password" id="wachtwoord" autocomplete="current-password" required autofocus>
      <button type="submit">Inloggen</button>
      <div id="loginFout" class="error" style="display:none;">Onjuist wachtwoord</div>
    </form>
  </div>

  <div class="container" id="adminContent" style="display:none;">
    <h2>Admin Overzicht</h2>
    <p>Je bent ingelogd als <b>admin</b>. <a href="klant.html">‚Üê Terug naar boekingspagina</a></p>
    <table id="rittenTable">
      <thead>
        <tr>
          <th>Rit-ID</th>
          <th>Ophaaladres</th>
          <th>Afzetadres</th>
          <th>Tijdstip</th>
          <th>Betaalmethode</th>
          <th>Kortingscode</th>
          <th>Huisdieren</th>
          <th>Spoedrit</th>
          <th>Geplande rit</th>
          <th>Opmerkingen</th>
        </tr>
      </thead>
      <tbody id="rittenBody">
        <!-- Ritten worden hier getoond -->
      </tbody>
    </table>
  </div>

  <script>
    // Admin login logic
    const ADMIN_WACHTWOORD_HASH = "c3e0e5f9c8b2a2d9f7e6e7e9b9c4a9e2a7f6c5d5e6a1b2c3d4e5f6a7b8c9d0e1f2";

    document.getElementById('loginForm').onsubmit = async function(e) {
      e.preventDefault();
      const pw = document.getElementById('wachtwoord').value;
      const hash = await sha256(pw);
      if (hash === ADMIN_WACHTWOORD_HASH) {
        document.getElementById('loginContainer').style.display = 'none';
        document.getElementById('adminContent').style.display = 'block';
        laadRitten();
      } else {
        document.getElementById('loginFout').style.display = 'block';
      }
    };

    async function sha256(str) {
      const buf = new TextEncoder().encode(str);
      const hashBuf = await crypto.subtle.digest('SHA-256', buf);
      return Array.from(new Uint8Array(hashBuf)).map(b => b.toString(16).padStart(2,'0')).join('');
    }

    function laadRitten() {
      const ritten = JSON.parse(localStorage.getItem('ritten') || '[]');
      const tb = document.getElementById('rittenBody');
      tb.innerHTML = '';
      if (!ritten.length) {
        tb.innerHTML = '<tr><td colspan="10" style="text-align:center;color:#888;">Nog geen ritten geboekt.</td></tr>';
        return;
      }
      ritten.slice().reverse().forEach(r => {
        const tr = document.createElement('tr');
        tr.innerHTML = `
          <td>${r.ritId||r.ritID||''}</td>
          <td>${r.ophaaladres||''}</td>
          <td>${r.afzetadres||''}</td>
          <td>${r.tijdstip||''}</td>
          <td>${r.betaalmethode||''}</td>
          <td>${r.kortingscode||''}</td>
          <td>${r.huisdieren||''}</td>
          <td>${r.spoedrit||r.spoed||''}</td>
          <td>${r.geplandeRit||''}</td>
          <td><button onclick="alert('Details: '+ JSON.stringify(r,null,2))">Details</button></td>
        `;
        tb.appendChild(tr);
      });
    }
  </script>
</body>
</html>
